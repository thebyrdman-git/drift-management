---
- name: Setup Cursor IDE Environment with Opinionated Standards
  hosts: localhost
  gather_facts: true
  
  vars:
    # Opinionated defaults (can be overridden)
    authoritative_config_source: "miraclemax.local"
    pull_config_from_source: true
    install_cursor: true
    
  pre_tasks:
    - name: Display Cursor environment setup standards
      ansible.builtin.debug:
        msg: |
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ’» CURSOR IDE ENVIRONMENT SETUP
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          
          Opinionated standards that will be enforced:
          
          âœ… Editor Settings:
             â€¢ Font: JetBrains Mono, 14pt
             â€¢ Indentation: 2 spaces (NEVER tabs)
             â€¢ Format on save: enabled
             â€¢ Trim whitespace: enabled
             â€¢ Auto-save: on focus change
          
          âœ… AI Configuration:
             â€¢ Primary model: claude-sonnet-4.5
             â€¢ Fallback: gpt-4o
             â€¢ Rules: synced from {{ authoritative_config_source }}
          
          âœ… Extensions (required):
             â€¢ Ansible (YAML syntax)
             â€¢ Python
             â€¢ Prettier (formatting)
             â€¢ Markdown linting
             â€¢ Docker support
          
          âœ… Rules Synchronization:
             â€¢ Global .cursorrules
             â€¢ AGENTS.md (assistant behavior)
             â€¢ GEMINI.md (Gemini config)
             â€¢ Project-specific rules
          
          âœ… Consistency Goal:
             Same development environment across:
             â€¢ Laptop
             â€¢ MiracleMax
             â€¢ Future systems
          
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      tags: [always]
  
  roles:
    - role: cursor_ide_manager
      tags: [cursor, ide]
    
    - role: cursor_rules_manager
      tags: [rules, agents]
  
  post_tasks:
    - name: Display next steps
      ansible.builtin.debug:
        msg: |
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          âœ… CURSOR ENVIRONMENT SETUP COMPLETE
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          
          ğŸ¯ What was configured:
          â€¢ Cursor IDE installed/updated
          â€¢ Settings synced from {{ authoritative_config_source }}
          â€¢ Extensions installed
          â€¢ Global rules synchronized
          â€¢ Project rules synchronized
          
          ğŸ”„ To update rules later:
          ansible-playbook setup-cursor-environment.yml --tags rules
          
          ğŸ’¡ To push local changes to source:
          ansible-playbook setup-cursor-environment.yml -e "sync_direction=push"
          
          ğŸ“ Edit standards:
          â€¢ Settings: drift-management/ansible/roles/cursor_ide_manager/defaults/main.yml
          â€¢ Rules source: {{ authoritative_config_source }}
          
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      tags: [always]

